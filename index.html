<html lang="ja"><head><script>(function(firebaseConfig, initialAuthToken, appId) {
        window.__firebase_config = firebaseConfig;
        window.__initial_auth_token = initialAuthToken;
        window.__app_id = appId;
            })("\n{\n  \"apiKey\": \"AIzaSyCqyCcs2R2e7AegGjvFAwG98wlamtbHvZY\",\n  \"authDomain\": \"bard-frontend.firebaseapp.com\",\n  \"projectId\": \"bard-frontend\",\n  \"storageBucket\": \"bard-frontend.firebasestorage.app\",\n  \"messagingSenderId\": \"175205271074\",\n  \"appId\": \"1:175205271074:web:2b7bd4d34d33bf38e6ec7b\"\n}\n","eyJhbGciOiJSUzI1NiIsImtpZCI6IjExYjc0YTUyNzgwMDk5ZjEzNDY0MmNlZWM3ZGE4MjNkMTc4MDc2ZjIiLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJmaXJlYmFzZS1hZG1pbnNkay1mYnN2Y0BiYXJkLWZyb250ZW5kLmlhbS5nc2VydmljZWFjY291bnQuY29tIiwiYXVkIjoiaHR0cHM6Ly9pZGVudGl0eXRvb2xraXQuZ29vZ2xlYXBpcy5jb20vZ29vZ2xlLmlkZW50aXR5LmlkZW50aXR5dG9vbGtpdC52MS5JZGVudGl0eVRvb2xraXQiLCJ1aWQiOiIwODI4OTE4NTc2MTY5NzY1ODAxMCIsImlzcyI6ImZpcmViYXNlLWFkbWluc2RrLWZic3ZjQGJhcmQtZnJvbnRlbmQuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLCJjbGFpbXMiOnsiYXBwSWQiOiJjXzU2YmFhMmEyZjZjZDIzYTBfaW5kZXguaHRtbC0yMDEifSwiZXhwIjoxNzY0NzM2MjY5LCJpYXQiOjE3NjQ3MzI2NjksImFsZyI6IlJTMjU2In0.IKUGRWxBsIrlO7nSQOMNEFKhzivYZ6jaE2t6YYpHDdfGxch32uvdbBalJUlML8djy3TPufFjjBkWhWKSigwiQYKxSBFJbo0o18U-tG-wGU6nUxS3D-k2sCvUHjROjNy3pHOiPVtRun4ljN2Pz1huXpni806xMyovUEIDmQ5mw1FD21EZ9-yTyK699u815L8i5FaULNuXrCkpltAKhb9AFUbOgxjJQu8JlDk4zvV_JP0Ma9Vk3KdOm2j7qsVsZHAab3fLNikz6yVMiDudP1Mv47JbPpOVqHRk5HYVTdLzjJzzu1Q7u7oUDee-sgVjQgaGqPllSYY6RR_b--NlG42kTw","c_56baa2a2f6cd23a0_index.html-201")</script><script>'use strict';var h=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,d){if(a==Array.prototype||a==Object.prototype)return a;a[b]=d.value;return a};function l(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var d=a[b];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");}var n=l(this);
function p(a,b){if(b)a:{var d=n;a=a.split(".");for(var c=0;c<a.length-1;c++){var e=a[c];if(!(e in d))break a;d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&b!=null&&h(d,a,{configurable:!0,writable:!0,value:b})}}function r(a){function b(c){return a.next(c)}function d(c){return a.throw(c)}return new Promise(function(c,e){function f(g){g.done?c(g.value):Promise.resolve(g.value).then(b,d).then(f,e)}f(a.next())})}function t(a){return r(a())}
p("Object.values",function(a){return a?a:function(b){var d=[],c;for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&d.push(b[c]);return d}});p("Array.prototype.includes",function(a){return a?a:function(b,d){var c=this;c instanceof String&&(c=String(c));var e=c.length;d=d||0;for(d<0&&(d=Math.max(d+e,0));d<e;d++){var f=c[d];if(f===b||Object.is(f,b))return!0}return!1}});/*

 MIT License

 Copyright (c) 2017-2023 W.Y.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.

*/
function u(a,b){const d=a.style;b.backgroundColor&&(d.backgroundColor=b.backgroundColor);b.width&&(d.width=`${b.width}px`);b.height&&(d.height=`${b.height}px`);const c=b.style;c!=null&&Object.keys(c).forEach(e=>{d[e]=c[e]})};var v=(()=>{let a=0;return()=>{a+=1;return`u${`0000${(Math.random()*1679616<<0).toString(36)}`.slice(-4)}${a}`}})();function w(a){const b=[];for(let d=0,c=a.length;d<c;d++)b.push(a[d]);return b}let x=null;function y(a={}){return x?x:a.l?x=a.l:x=w(window.getComputedStyle(document.documentElement))}function z(a,b){return(a=(a.ownerDocument.defaultView||window).getComputedStyle(a).getPropertyValue(b))?parseFloat(a.replace("px","")):0}
function A(a,b={}){var d;if(!(d=b.width)){d=z(a,"border-left-width");var c=z(a,"border-right-width");d=a.clientWidth+d+c}(b=b.height)||(b=z(a,"border-top-width"),c=z(a,"border-bottom-width"),b=a.clientHeight+b+c);return{width:d,height:b}}function B(a){return new Promise((b,d)=>{const c=new Image;c.onload=()=>{c.decode().then(()=>{requestAnimationFrame(()=>b(c))})};c.onerror=d;c.crossOrigin="anonymous";c.decoding="async";c.src=a})}
function C(a){return t(function*(){return Promise.resolve().then(()=>(new XMLSerializer).serializeToString(a)).then(encodeURIComponent).then(b=>`data:image/svg+xml;charset=utf-8,${b}`)})}
function D(a,b,d){return t(function*(){const c=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");c.setAttribute("width",`${b}`);c.setAttribute("height",`${d}`);c.setAttribute("viewBox",`0 0 ${b} ${d}`);e.setAttribute("width","100%");e.setAttribute("height","100%");e.setAttribute("x","0");e.setAttribute("y","0");e.setAttribute("externalResourcesRequired","true");c.appendChild(e);e.appendChild(a);return C(c)})}
var E=(a,b)=>{if(a instanceof b)return!0;a=Object.getPrototypeOf(a);return a===null?!1:a.constructor.name===b.name||E(a,b)};function F(a,b){return y(b).map(d=>{const c=a.getPropertyValue(d),e=a.getPropertyPriority(d);return`${d}: ${c}${e?" !important":""};`}).join(" ")}
function G(a,b,d,c){a=window.getComputedStyle(a,d);var e=a.getPropertyValue("content");if(e!==""&&e!=="none"){var f=v();try{b.className=`${b.className} ${f}`}catch(k){return}e=document.createElement("style");var g=e.appendChild;d=`.${f}:${d}`;a.cssText?(c=a.getPropertyValue("content"),c=`${a.cssText} content: '${c.replace(/'|"/g,"")}';`):c=F(a,c);g.call(e,document.createTextNode(`${d}{${c}}`));b.appendChild(e)}};function H(a){return a.search(/^(data:)/)!==-1}function I(a,b,d){return t(function*(){const c=yield fetch(a,b);if(c.status===404)throw Error(`Resource "${c.url}" not found`);const e=yield c.blob();return new Promise((f,g)=>{const k=new FileReader;k.onerror=g;k.onloadend=()=>{try{f(d({o:c,result:k.result}))}catch(m){g(m)}};k.readAsDataURL(e)})})}const J={};function K(a,b,d){let c=a.replace(/\?.*/,"");d&&(c=a);/ttf|otf|eot|woff2?/i.test(c)&&(c=c.replace(/.*\//,""));return b?`[${b}]${c}`:c}
function L(a,b,d){return t(function*(){const c=K(a,b,d.C);if(J[c]!=null)return J[c];d.u&&(a+=(/\?/.test(a)?"&":"?")+(new Date).getTime());let e;try{const f=yield I(a,d.i,({o:g,result:k})=>{b||(b=g.headers.get("Content-Type")||"");return k.split(/,/)[1]});e=`data:${b};base64,${f}`}catch(f){e=d.B||""}return J[c]=e})};const M={P:"application/font-woff",R:"application/font-woff",N:"application/font-truetype",v:"application/vnd.ms-fontobject",H:"image/png",F:"image/jpeg",D:"image/jpeg",A:"image/gif",M:"image/tiff",L:"image/svg+xml",O:"image/webp"};function N(a){return(a=/\.([^./]*?)$/g.exec(a))?a[1]:""};function O(a){return t(function*(){const b=a.toDataURL();return b==="data:,"?a.cloneNode(!1):B(b)})}function aa(a,b){return t(function*(){if(a.currentSrc){var d=document.createElement("canvas");const c=d.getContext("2d");d.width=a.clientWidth;d.height=a.clientHeight;c==null||c.drawImage(a,0,0,d.width,d.height);d=d.toDataURL();return B(d)}d=a.poster;d=yield L(d,M[N(d).toLowerCase()]||"",b);return B(d)})}
function ba(a,b){return t(function*(){try{let d;if(a==null?0:(d=a.contentDocument)==null?0:d.body)return yield P(a.contentDocument.body,b,!0)}catch(d){}return a.cloneNode(!1)})}function ca(a,b){return t(function*(){return E(a,HTMLCanvasElement)?O(a):E(a,HTMLVideoElement)?aa(a,b):E(a,HTMLIFrameElement)?ba(a,b):a.cloneNode(a.tagName!=null&&a.tagName.toUpperCase()==="SVG")})}
function da(a,b,d){return t(function*(){if(b.tagName!=null&&b.tagName.toUpperCase()==="SVG")return b;let c=[];if(a.tagName!=null&&a.tagName.toUpperCase()==="SLOT"&&a.assignedNodes)c=w(a.assignedNodes());else{let e;if(E(a,HTMLIFrameElement)&&((e=a.contentDocument)==null?0:e.body))c=w(a.contentDocument.body.childNodes);else{let f;c=w(((f=a.shadowRoot)!=null?f:a).childNodes)}}if(c.length===0||E(a,HTMLVideoElement))return b;yield c.reduce((e,f)=>e.then(()=>P(f,d)).then(g=>{g&&b.appendChild(g)}),Promise.resolve());
return b})}function ea(a,b,d){const c=b.style;if(c){var e=window.getComputedStyle(a);e.cssText?(c.cssText=e.cssText,c.transformOrigin=e.transformOrigin):y(d).forEach(f=>{let g=e.getPropertyValue(f);f==="font-size"&&g.endsWith("px")&&(g=`${Math.floor(parseFloat(g.substring(0,g.length-2)))-.1}px`);E(a,HTMLIFrameElement)&&f==="display"&&g==="inline"&&(g="block");f==="d"&&b.getAttribute("d")&&(g=`path(${b.getAttribute("d")})`);c.setProperty(f,g,e.getPropertyPriority(f))})}}
function fa(a,b){E(a,HTMLSelectElement)&&(b=Array.from(b.children).find(d=>a.value===d.getAttribute("value")))&&b.setAttribute("selected","")}
function ha(a,b){return t(function*(){var d=a.querySelectorAll?a.querySelectorAll("use"):[];if(d.length===0)return a;var c={};for(var e=0;e<d.length;e++){var f=d[e].getAttribute("xlink:href");if(f){const g=document.querySelector(f);a.querySelector(f)||!g||c[f]||(c[f]=yield P(g,b,!0))}}d=Object.values(c);if(d.length){c=document.createElementNS("http://www.w3.org/1999/xhtml","svg");c.setAttribute("xmlns","http://www.w3.org/1999/xhtml");c.style.position="absolute";c.style.width="0";c.style.height="0";
c.style.overflow="hidden";c.style.display="none";e=document.createElementNS("http://www.w3.org/1999/xhtml","defs");c.appendChild(e);for(f=0;f<d.length;f++)e.appendChild(d[f]);a.appendChild(c)}return a})}
function P(a,b,d){return t(function*(){return d||!b.filter||b.filter(a)?Promise.resolve(a).then(c=>ca(c,b)).then(c=>da(a,c,b)).then(c=>{E(c,Element)&&(ea(a,c,b),G(a,c,":before",b),G(a,c,":after",b),E(a,HTMLTextAreaElement)&&(c.textContent=a.value),E(a,HTMLInputElement)&&c.setAttribute("value",a.value),fa(a,c));return c}).then(c=>ha(c,b)):null})};const Q=/url\((['"]?)([^'"]+?)\1\)/g,ia=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,ja=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function ka(a){const b=[];a.replace(Q,(d,c,e)=>{b.push(e);return d});return b.filter(d=>!H(d))}
function la(a,b,d,c){return t(function*(){try{const e=d?(new URL(b,d||void 0)).toString():b;let f;f=yield L(e,M[N(b).toLowerCase()]||"",c);return a.replace(new RegExp(`(url\\(['"]?)(${b.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")})(['"]?\\))`,"g"),`$1${f}$3`)}catch(e){}return a})}function ma(a,{I:b}){return b?a.replace(ja,d=>{for(;;){const [c,,e]=ia.exec(d)||[],f=c,g=e;if(!g)return"";if(g===b)return`src: ${f};`}}):a}
function R(a,b,d){return t(function*(){if(a.search(Q)===-1)return a;const c=ma(a,d);return ka(c).reduce((e,f)=>e.then(g=>la(g,f,b,d)),Promise.resolve(c))})};function S(a,b,d){return t(function*(){var c;const e=(c=b.style)==null?void 0:c.getPropertyValue(a);return e?(c=yield R(e,null,d),b.style.setProperty(a,c,b.style.getPropertyPriority(a)),!0):!1})}function na(a,b){return t(function*(){(yield S("background",a,b))||(yield S("background-image",a,b));(yield S("mask",a,b))||(yield S("-webkit-mask",a,b))||(yield S("mask-image",a,b))||(yield S("-webkit-mask-image",a,b))})}
function oa(a,b){return t(function*(){const d=E(a,HTMLImageElement);if(d&&!H(a.src)||E(a,SVGImageElement)&&!H(a.href.baseVal)){var c=d?a.src:a.href.baseVal,e=yield L(c,M[N(c).toLowerCase()]||"",b);yield new Promise((f,g)=>{a.onload=f;a.onerror=b.m?(...k)=>{try{f(b.m(...k))}catch(m){g(m)}}:g;a.decode&&(a.decode=f);a.loading==="lazy"&&(a.loading="eager");d?(a.srcset="",a.src=e):a.href.baseVal=e})}})}
function pa(a,b){return t(function*(){const d=w(a.childNodes).map(c=>T(c,b));yield Promise.all(d).then(()=>a)})}function T(a,b){return t(function*(){E(a,Element)&&(yield na(a,b),yield oa(a,b),yield pa(a,b))})};const U={};function V(a){return t(function*(){var b=U[a];if(b!=null)return b;b=yield(yield fetch(a)).text();b={url:a,cssText:b};return U[a]=b})}function W(a,b){return t(function*(){let d=a.cssText;const c=/url\(["']?([^"')]+)["']?\)/g,e=(d.match(/url\([^)]+\)/g)||[]).map(f=>t(function*(){let g=f.replace(c,"$1");g.startsWith("https://")||(g=(new URL(g,a.url)).href);return I(g,b.i,({result:k})=>{d=d.replace(f,`url(${k})`);return[f,k]})}));return Promise.all(e).then(()=>d)})}
function X(a){if(a==null)return[];const b=[];a=a.replace(/(\/\*[\s\S]*?\*\/)/gi,"");for(var d=RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");;){var c=d.exec(a);if(c===null)break;b.push(c[0])}a=a.replace(d,"");d=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi;for(c=RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");;){let e=d.exec(a);if(e===null)if(e=c.exec(a),e===null)break;else d.lastIndex=c.lastIndex;else c.lastIndex=
d.lastIndex;b.push(e[0])}return b}
function qa(a,b){return t(function*(){const d=[],c=[];a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach((f,g)=>{if(f.type===CSSRule.IMPORT_RULE){let k=g+1;f=V(f.href).then(m=>W(m,b)).then(m=>X(m).forEach(q=>{try{e.insertRule(q,q.startsWith("@import")?k+=1:e.cssRules.length)}catch(Da){}})).catch(()=>{});c.push(f)}})}catch(f){const g=a.find(k=>k.href==null)||document.styleSheets[0];e.href!=null&&c.push(V(e.href).then(k=>W(k,b)).then(k=>X(k).forEach(m=>{g.insertRule(m,g.cssRules.length)})).catch(()=>
{}))}});return Promise.all(c).then(()=>{a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach(f=>{d.push(f)})}catch(f){}});return d})})}function ra(a){return a.filter(b=>b.type===CSSRule.FONT_FACE_RULE).filter(b=>b.style.getPropertyValue("src").search(Q)!==-1)}function sa(a,b){return t(function*(){if(a.ownerDocument==null)throw Error("Provided element is not within a Document");var d=w(a.ownerDocument.styleSheets);d=yield qa(d,b);return ra(d)})}
function ta(a){function b(c){(c.style.fontFamily||getComputedStyle(c).fontFamily).split(",").forEach(e=>{d.add(e.trim().replace(/["']/g,""))});Array.from(c.children).forEach(e=>{e instanceof HTMLElement&&b(e)})}const d=new Set;b(a);return d}function ua(a,b){return t(function*(){const d=yield sa(a,b),c=ta(a);return(yield Promise.all(d.filter(e=>c.has(e.style.fontFamily.trim().replace(/["']/g,""))).map(e=>R(e.cssText,e.parentStyleSheet?e.parentStyleSheet.href:null,b)))).join("\n")})}
function va(a,b){return t(function*(){const d=b.j!=null?b.j:b.K?null:yield ua(a,b);if(d){const c=document.createElement("style");c.appendChild(document.createTextNode(d));a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c)}})};function wa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b),e=yield P(a,b,!0);yield va(e,b);yield T(e,b);u(e,b);return yield D(e,d,c)})}
function xa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b);var e=yield wa(a,b);e=yield B(e);const f=document.createElement("canvas"),g=f.getContext("2d"),k=b.G||window.devicePixelRatio||1,m=b.h||d,q=b.g||c;f.width=m*k;f.height=q*k;!b.J&&(f.width>16384||f.height>16384)&&(f.width>16384&&f.height>16384?f.width>f.height?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=16384):f.width>16384?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=
16384));f.style.width=`${m}`;f.style.height=`${q}`;b.backgroundColor&&(g.fillStyle=b.backgroundColor,g.fillRect(0,0,f.width,f.height));g.drawImage(e,0,0,f.width,f.height);return f})}function ya(a,b={}){return t(function*(){return(yield xa(a,b)).toDataURL()})};const za=["gemini.google.com","corp.google.com","proxy.googlers.com"];function Y(){return document.body.querySelectorAll('[class*="animate"]').length>0}function Z(a){return t(function*(){try{return yield ya(a,{h:a.offsetWidth,g:a.offsetHeight})}catch(d){var b=a.offsetHeight;const c=document.createElement("canvas");c.width=a.offsetWidth;c.height=b;return c.toDataURL("image/png")}})}
function Aa(){return t(function*(){const a=document.body.offsetWidth,b=document.body.offsetHeight,d=document.body.cloneNode(!0);d.querySelectorAll('[class*="animate"]').forEach(c=>{c.classList.remove(...Array.from(c.classList).filter(e=>e.startsWith("animate")))});d.style.width=`${a}px`;d.style.height=`${b}px`;return d})}
function Ba(a){return t(function*(){let b=document.body;if(Y()){var d=yield Aa();b=d;document.body.appendChild(d)}d=yield Z(b);Y()&&document.body.removeChild(b);window.parent.postMessage({type:"SEND_SCREENSHOT",image:d,topOffset:document.documentElement.scrollTop},a.origin)})}function Ca(a){return t(function*(){const b={type:"SEND_SCREENSHOT_FOR_DATA_VISUALIZATION",image:yield Z(document.body),topOffset:0};window.parent.postMessage(b,a.origin)})}
window.addEventListener("message",a=>t(function*(){if(za.some(d=>a.origin.includes(d))){var b=a.data;b&&(b.type==="MAKE_SCREENSHOT"&&(yield Ba(a)),b.type==="MAKE_SCREENSHOT_FOR_DATA_VISUALIZATION"&&(yield Ca(a)))}}));
</script><script>(function() {
  // Ensure this script is executed only once
  if (window.firebaseAuthBridgeScriptLoaded) {
    return;
  }
  window.firebaseAuthBridgeScriptLoaded = true;

  let nextTokenPromiseId = 0;

  // Stores { resolve, reject } for ongoing token requests
  const pendingTokenPromises = {};

  // Listen for messages from the Host Application
  window.addEventListener('message', function(event) {

    const messageData = event.data;

  if (messageData && messageData.type === 'RESOLVE_NEW_FIREBASE_TOKEN') {
      const { success, token, error, promiseId } = messageData ?? {};
      if (pendingTokenPromises[promiseId]) {
        if (success) {
          pendingTokenPromises[promiseId].resolve(token);
        } else {
          pendingTokenPromises[promiseId].reject(new Error(error || 'Token refresh failed from host.'));
        }
        delete pendingTokenPromises[promiseId];
      }
    }
  });

  // Expose a function for the Generated App to request a new Firebase token
  window.requestNewFirebaseToken = function() {
    const currentPromiseId = nextTokenPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingTokenPromises[currentPromiseId] = { resolve, reject };
    });
    if (window.parent && window.parent !== window) {
      window.parent.postMessage({
        type: 'REQUEST_NEW_FIREBASE_TOKEN',
        promiseId: currentPromiseId
      }, '*');
    } else {
      pendingTokenPromises[currentPromiseId].reject(new Error('No parent window to request token from.'));
      delete pendingTokenPromises[currentPromiseId];
    }
    return promise;
  };
})();</script><script>
let realOriginalGetUserMedia = null;
if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
  realOriginalGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);
}

(function() {
  if (navigator.mediaDevices && navigator.mediaDevices.__proto__) {
    try {
      Object.defineProperty(navigator.mediaDevices.__proto__, 'getUserMedia', {
        get: function() {
          return undefined; // Or throw an error
        },
        configurable: false
      });
    } catch (error) {
      console.error("Error defining prototype getter:", error);
    }
  }
})();

(function() {
  const pendingMediaResolvers = {};
  let nextMediaPromiseId = 0;

  function requestMediaPermissions(constraints) {
    const mediaPromiseId = nextMediaPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingMediaResolvers[mediaPromiseId] = (granted) => {
        delete pendingMediaResolvers[mediaPromiseId];
        resolve(granted);
      };
    });

    window.parent.postMessage({
      type: 'requestMediaPermission',
      constraints: constraints,
      promiseId: mediaPromiseId,
    }, '*');

    return promise;
  }

  let originalGetUserMedia = realOriginalGetUserMedia;

  function interceptGetUserMedia() {
    if (navigator.mediaDevices) {
      Object.defineProperty(navigator.mediaDevices, 'getUserMedia', {
        value: function(constraints) {
          return requestMediaPermissions(constraints).then((granted) => {
            if (granted) {
              if (originalGetUserMedia) {
                return originalGetUserMedia(constraints);
              } else {
                throw new Error("Original getUserMedia not available.");
              }
            } else {
              throw new DOMException('Permission denied', 'NotAllowedError');
            }
          });
        },
        writable: false,
        configurable: false
      });
    }
  }

  interceptGetUserMedia();

  const observer = new MutationObserver(function(mutationsList, observer) {
    for (const mutation of mutationsList) {
      if (mutation.type === 'reconfigured' && mutation.name === 'getUserMedia' && mutation.object === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'attributes' && mutation.attributeName === 'getUserMedia' && mutation.target === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'childList' && mutation.addedNodes) {
        mutation.addedNodes.forEach(node => {
          if (node === navigator.mediaDevices) {
            interceptGetUserMedia();
          }
        });
      }
    }
  });

  function interceptSpeechRecognition() {
    if (!window.SpeechRecognition && !window.webkitSpeechRecognition) {
      return;
    }

    const OriginalSpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    const SpeechRecognitionWrapper = function(...args) {
      const recognizer = new OriginalSpeechRecognition(...args);
      const originalStart = recognizer.start.bind(recognizer);

      recognizer.start = function() {
        requestMediaPermissions({ audio: true }).then(granted => {
          if (granted) {
            originalStart();
          } else {
            const errorEvent = new SpeechRecognitionErrorEvent('error');
            errorEvent.error = 'not-allowed'; // This is the standard error for permission denial.
            recognizer.dispatchEvent(errorEvent);
          }
        });
      };

      return recognizer;
    };

    SpeechRecognitionWrapper.prototype = OriginalSpeechRecognition.prototype;
    SpeechRecognitionWrapper.prototype.constructor = SpeechRecognitionWrapper;

    if (window.SpeechRecognition) {
      window.SpeechRecognition = SpeechRecognitionWrapper;
    }
    if (window.webkitSpeechRecognition) {
      window.webkitSpeechRecognition = SpeechRecognitionWrapper;
    }
  }

  interceptSpeechRecognition();

  window.addEventListener('message', function(event) {
    if (event.data) {
      if (event.data.type === 'resolveMediaPermission') {
        const { promiseId, granted } = event.data;
        if (pendingMediaResolvers[promiseId]) {
          pendingMediaResolvers[promiseId](granted);
        }
      }
    }
  });

})();</script><script>((function(modelInformation) {
  const originalFetch = window.fetch;
  // TODO: b/421908508 - Move these out of the script and match all generative AI model calls.
  let googleLlmBaseApiUrls = [
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':streamGenerateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageEditModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageTransformModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.ttsModelName + ':generateContent',
  ];
  modelInformation.deprecatedTextModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':streamGenerateContent',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':generateContent',
    );
  });
  modelInformation.deprecatedImageModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':predict',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':predictLongRunning',
    );
  });

  const pendingFetchResolvers = {};
  let nextPromiseId = 0;

  function handleStringInput(input, optionsArgument) {
    const actualUrl = input;
    const fetchCallArgs = [actualUrl, optionsArgument];
    const effectiveOptions = optionsArgument || {};
    const bodyForApiKeyCheck = effectiveOptions.body;
    const bodyForPostMessage = effectiveOptions.body;
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  function handleRequestInput(input, optionsArgument) {
    const actualUrl = input.url;
    const fetchCallArgs = [input, optionsArgument];
    const effectiveOptions = { method: input.method, headers: new Headers(input.headers) };
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (optionsArgument) {
      if (optionsArgument.method) effectiveOptions.method = optionsArgument.method;
      if (optionsArgument.headers) effectiveOptions.headers = new Headers(optionsArgument.headers);
      if ('body' in optionsArgument) {
        bodyForApiKeyCheck = optionsArgument.body;
        bodyForPostMessage = optionsArgument.body;
      } else {
        bodyForApiKeyCheck = undefined;
        bodyForPostMessage = input.body;
      }
    } else {
      bodyForApiKeyCheck = undefined;
      bodyForPostMessage = input.body;
    }
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  window.fetch = function(input, optionsArgument) {
    let actualUrl;
    let fetchCallArgs;
    let effectiveOptions = {};
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (typeof input === 'string') {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleStringInput(input, optionsArgument));
    } else if (input instanceof Request) {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleRequestInput(input, optionsArgument));
    } else {
      return originalFetch.apply(window, [input, optionsArgument]);
    }

    effectiveOptions.method = effectiveOptions.method || 'GET';
    if (!effectiveOptions.headers) {
      effectiveOptions.headers = new Headers();
    }


    if (typeof actualUrl === 'string' && googleLlmBaseApiUrls.some((url) => actualUrl.startsWith(url))) {
      let apiKeyIsNull = true;

      const regex = new RegExp("models/([^:]+)");
      const modelNameMatch = actualUrl.match(regex);
      const modelName = modelNameMatch ? modelNameMatch[1] : 'unspecified';


      try {
        const urlObject = new URL(actualUrl);  // Use URL object for robust parsing
        const apiKeyParam = urlObject.searchParams.get('key');
        if (apiKeyParam) {
          apiKeyIsNull = false;
        }
      } catch (e) {
        // Continue checks even if URL parsing fails
      }

      if (apiKeyIsNull && effectiveOptions.headers) {
        const h = new Headers(effectiveOptions.headers);
        const apiKeyHeaderValue = h.get('X-API-Key') || h.get('x-api-key');
        if (apiKeyHeaderValue) {
          apiKeyIsNull = false;
          return originalFetch.apply(window, fetchCallArgs);
        }
      }

      if (apiKeyIsNull && effectiveOptions.method && ['POST', 'PUT', 'PATCH'].includes(effectiveOptions.method.toUpperCase()) && typeof bodyForApiKeyCheck === 'string') {
        try {
          const bodyData = JSON.parse(bodyForApiKeyCheck);
          if (bodyData && bodyData.apiKey) {
            apiKeyIsNull = false;
            return originalFetch.apply(window, fetchCallArgs);
          }
        } catch (e) {
          // Ignore JSON parsing errors
        }
      }

      if(apiKeyIsNull) {
        const promiseId = nextPromiseId++;
        const promise = new Promise((resolve) => {
          pendingFetchResolvers[promiseId] = (resolvedResponse) => {
            delete pendingFetchResolvers[promiseId];
            resolve(resolvedResponse);
          };
        });

        let serializedBodyForPostMessage;
        if (typeof bodyForPostMessage === 'string' || bodyForPostMessage == null) {
            serializedBodyForPostMessage = bodyForPostMessage;
        } else if (bodyForPostMessage instanceof ReadableStream) {
            serializedBodyForPostMessage = null;
        } else {
            try {
                serializedBodyForPostMessage = JSON.stringify(bodyForPostMessage);
            } catch (e) {
                serializedBodyForPostMessage = null;
            }
        }

        const messageOptions = {
            method: effectiveOptions.method,
            headers: Object.fromEntries(new Headers(effectiveOptions.headers).entries()),
            body: serializedBodyForPostMessage
        };

        window.parent.postMessage({
          type: 'requestFetch',
          url: actualUrl,
          modelName: modelName,
          options: messageOptions,
          promiseId: promiseId,
        }, '*');

        return promise;
      }
      return originalFetch.apply(window, fetchCallArgs);
    }
    return originalFetch.apply(window, fetchCallArgs);
  };

  window.addEventListener('message', function(event) {
    if (event.data && event.data.type === 'resolveFetch') {
      const { promiseId, response } = event.data;
      if (pendingFetchResolvers[promiseId]) {
        try {
          const reconstructedResponse = new Response(response.body, {
            status: response.status,
            statusText: response.statusText,
            headers: new Headers(response.headers),
          });
          pendingFetchResolvers[promiseId](reconstructedResponse);
        } catch (error) {
          pendingFetchResolvers[promiseId](new Response(null, { status: 500, statusText: "Interceptor Response Reconstruction Error" }));
        }
      }
    }
  });

}))({"textModelName":"gemini-2.5-flash-preview-09-2025","imageModelName":"imagen-4.0-generate-001","imageEditModelName":"gemini-2.5-flash-image-preview","imageTransformModelName":"gemini-2.5-flash-image-preview","videoModelName":"veo-2.0-generate-001","ttsModelName":"gemini-2.5-flash-preview-tts","deprecatedTextModelNames":["gemini-2.0-flash","gemini-2.5-flash-preview-04-17","gemini-2.5-flash-preview-05-20"],"deprecatedImageModelNames":["imagen-3.0-generate-001","imagen-3.0-generate-002"]})</script><script>(function() {
  const originalConsoleLog = console.log;
  const originalConsoleError = console.error;

    /**
   * Normalizes an error event or a promise rejection reason into a structured error object.
   * @param {*} errorEventOrReason The error object or reason.
   * @return {object} Structured error data { message, name, stack }.
   */
  function getErrorObject(errorEventOrReason) {
    if (errorEventOrReason instanceof Error) {
      return {
        message: errorEventOrReason.message,
        name: errorEventOrReason.name,
        stack: errorEventOrReason.stack,
      };
    }
    // Fallback for non-Error objects.
    try {
      return {
        message: JSON.stringify(errorEventOrReason),
        name: 'UnknownErrorType',
        stack: null,
      };
    } catch (e) {
      return {
        message: String(errorEventOrReason),
        name: 'UnknownErrorTypeNonStringifiable',
        stack: null,
      };
    }
  }

  /**
   * Converts an array of arguments (from log/error) into a single string.
   * Handles Error objects specially to include their message and stack.
   * @param {Array<*>} args - Arguments passed to console methods.
   * @return {string} A string representation of the arguments.
   */
  function stringifyArgs(args) {
    return args
      .map((arg) => {
        if (arg instanceof Error) {
          const {message, stack} = arg;
          return `Error: ${message}${stack ? ('\nStack: ' + stack) : ''}`;
        }
        if (typeof arg === 'object' && arg !== null) {
          try {
            return JSON.stringify(arg);
          } catch (error) {
            return '[Circular Object]';
          }
        } else {
          return String(arg);
        }
      })
      .join(' ');
  }

  console.log = function(...args) {
    const logString = stringifyArgs(args);
    window.parent.postMessage({ type: 'log', message: logString }, '*');
    originalConsoleLog.apply(console, args);
  };

  console.error = function(...args) {
    let errorData;
    if (args.length > 0 && args[0] instanceof Error) {
      const err = args[0];
      // If the first arg is an Error, capture its details.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        ...getErrorObject(err),
        rawArgsString: stringifyArgs(args.slice(1)),
        timestamp: new Date().toISOString(),
      };
    } else {
      // If not an Error object, treat all args as a general error message.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        message: stringifyArgs(args),
        name: 'ConsoleLoggedError',
        stack: null,
        timestamp: new Date().toISOString(),
      };
    }
    window.parent.postMessage(errorData, '*');
    originalConsoleError.apply(console, args);
  };

  // Listen for global unhandled synchronous errors.
  window.addEventListener('error', function(event) {
    const errorDetails = event.error ? getErrorObject(event.error) : {
      message: event.message,
      name: 'GlobalError',
      stack: null,
      filename: event.filename,
      lineno: event.lineno,
      colno: event.colno,
    };

    window.parent.postMessage({
      type: 'error',
      source: 'global',
      ...errorDetails,
      message: errorDetails.message || event.message,
      timestamp: new Date().toISOString(),
    }, '*');
  });

  // Listen for unhandled promise rejections (asynchronous errors).
  window.addEventListener('unhandledrejection', function(event) {
    const errorDetails = getErrorObject(event.reason);

    window.parent.postMessage({
      type: 'error',
      source: 'unhandledrejection',
      ...errorDetails,
      message: errorDetails.message || 'Unhandled Promise Rejection',
      timestamp: new Date().toISOString(),
    }, '*');
  });

})();</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>秋山 潤樹 | Digital Business Card</title>
    
    <!-- SNSシェア時の設定 (OGP) -->
    <meta property="og:title" content="秋山 潤樹 - Digital Business Card">
    <meta property="og:description" content="スマホ講師 / AIプランナー / 空間デザイナー | デジタル名刺">
    <meta property="og:type" content="website">
    <!-- 公開後、ここにスクリーンショット画像のURLを入れるとLINEなどで画像が表示されます -->
    <!-- <meta property="og:image" content="https://your-github-id.github.io/repo-name/card-image.png"> -->

    <!-- スマホ用アイコン・アプリ化設定 -->
    <meta name="theme-color" content="#1a1a1a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="icon" href="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text y=%22.9em%22 font-size=%2290%22&gt;l&lt;/text&gt;&lt;/svg&gt;">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.0.2/marked.min.js" crossorigin="anonymous"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700;900&display=swap');

        :root {
            --card-width: 320px;
            --card-height: 540px;
            --glare-opacity: 0.5;
            --brand-yellow: #fff100;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background-color: #1a1a1a;
            perspective: 1000px;
            overflow: hidden;
            touch-action: none;
            /* iPhoneなどでのバウンススクロール防止 */
            overscroll-behavior: none;
        }

        /* カードのコンテナ */
        .card-container {
            width: var(--card-width);
            height: var(--card-height);
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.1s ease-out;
            cursor: pointer;
            border-radius: 20px;
            box-shadow: 
                0 20px 50px rgba(0,0,0,0.5),
                0 0 0 1px rgba(255,255,255,0.1);
        }

        /* 表面と裏面の共通設定 */
        .card-face {
            position: absolute; /* ここが重要: 絶対配置で重ねる */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 20px;
            overflow: hidden;
            transform-style: preserve-3d;
            will-change: transform; 
        }

        /* 表面（ロゴサイド） */
        .card-front {
            background-color: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2;
        }

        /* 裏面（情報サイド） */
        .card-back {
            background-color: #fff;
            transform: rotateY(180deg);
            z-index: 1;
            display: flex;
            flex-direction: column;
            justify-content: flex-start; 
            align-items: flex-start;
            font-family: 'Noto Sans JP', sans-serif;
            text-align: left;
        }

        /* ホログラム・光沢エフェクト */
        .glare {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 20px;
            background: radial-gradient(
                circle at var(--pointer-x) var(--pointer-y), 
                rgba(255, 255, 255, 0.8) 0%, 
                rgba(255, 255, 255, 0.2) 20%, 
                rgba(0, 0, 0, 0) 60%
            );
            mix-blend-mode: overlay;
            opacity: var(--glare-opacity);
            pointer-events: none;
            z-index: 10;
        }

        .hologram {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 20px;
            background: linear-gradient(
                115deg, 
                transparent 20%, 
                rgba(255, 0, 150, 0.3) 30%, 
                rgba(0, 255, 255, 0.3) 45%, 
                transparent 60%
            );
            mix-blend-mode: color-dodge;
            opacity: 0.6;
            background-position: var(--bg-x) var(--bg-y);
            background-size: 200% 200%;
            pointer-events: none;
            z-index: 9;
        }

        /* ロゴデザイン */
        .lot-logo {
            font-family: 'Arial', sans-serif;
            font-weight: bold;
            font-size: 140px;
            color: white;
            letter-spacing: -5px;
            position: relative;
            transform: translateZ(50px);
        }
        
        .lot-o {
            display: inline-block;
            width: 110px;
            height: 110px;
            background-color: var(--brand-yellow);
            border-radius: 50%;
            margin: 0 -15px;
            position: relative;
            top: 15px;
            box-shadow: 0 0 20px rgba(255, 241, 0, 0.5);
        }

        .text-content {
            transform: translateZ(20px); 
            z-index: 50;
        }

        /* 下部のメニューバー */
        .menu-bar {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 15px;
            z-index: 100;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(10px);
            padding: 12px 20px;
            border-radius: 50px;
            border: 1px solid rgba(255,255,255,0.1);
            margin-bottom: env(safe-area-inset-bottom, 0px);
        }

        .menu-btn {
            color: white;
            font-size: 20px;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            background: rgba(255,255,255,0.1);
        }

        .menu-btn:active {
            transform: scale(0.9);
            background: rgba(255,255,255,0.3);
        }
        
        .menu-btn.download-btn {
            background: rgba(255, 241, 0, 0.2);
            color: #fff100;
        }
        
        .menu-btn.ai-btn {
            background: linear-gradient(135deg, #6366f1, #a855f7);
            color: white;
            box-shadow: 0 0 10px rgba(168, 85, 247, 0.5);
        }

        /* モーダル共通 */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 200;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            backdrop-filter: blur(5px);
        }

        .modal.active {
            opacity: 1;
            pointer-events: auto;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            transform: scale(0.9);
            transition: transform 0.3s;
            max-width: 90%;
            width: 340px; 
        }
        
        .chat-modal-content {
            padding: 0;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 500px;
            background: #f3f4f6;
        }

        .chat-header {
            background: white;
            padding: 15px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            text-align: left;
        }

        .message {
            max-width: 80%;
            padding: 10px 14px;
            border-radius: 15px;
            font-size: 14px;
            line-height: 1.4;
        }

        .message.user {
            background-color: #000;
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 2px;
        }

        .message.ai {
            background-color: white;
            color: #333;
            align-self: flex-start;
            border-bottom-left-radius: 2px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        
        .message.ai ul {
            list-style-type: disc;
            margin-left: 20px;
            margin-top: 5px;
            margin-bottom: 5px;
        }
        
        .message.ai strong {
            font-weight: bold;
        }

        .chat-input-area {
            background: white;
            padding: 10px;
            border-top: 1px solid #e5e7eb;
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            border: 1px solid #d1d5db;
            border-radius: 20px;
            padding: 8px 15px;
            font-size: 14px;
            outline: none;
        }
        
        .chat-input:focus {
            border-color: #000;
        }

        .send-btn {
            background: #000;
            color: white;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .typing-indicator {
            display: flex;
            gap: 4px;
            padding: 5px 10px;
            background: white;
            border-radius: 15px;
            align-self: flex-start;
            margin-bottom: 10px;
            display: none;
        }
        
        .typing-dot {
            width: 6px;
            height: 6px;
            background: #ccc;
            border-radius: 50%;
            animation: bounce 1.4s infinite ease-in-out both;
        }
        
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        
        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }

        .hint-text {
            position: fixed;
            top: 100px;
            width: 100%;
            text-align: center;
            color: rgba(255,255,255,0.5);
            font-size: 14px;
            pointer-events: none;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.3; }
            50% { opacity: 0.7; }
            100% { opacity: 0.3; }
        }

    </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.bottom-0{bottom:0px}.bottom-4{bottom:1rem}.left-0{left:0px}.left-4{left:1rem}.left-5{left:1.25rem}.right-4{right:1rem}.top-4{top:1rem}.top-5{top:1.25rem}.z-20{z-index:20}.z-50{z-index:50}.mb-1{margin-bottom:0.25rem}.mb-2{margin-bottom:0.5rem}.mb-4{margin-bottom:1rem}.ml-4{margin-left:1rem}.mr-2{margin-right:0.5rem}.mt-4{margin-top:1rem}.flex{display:flex}.hidden{display:none}.h-screen{height:100vh}.h-2{height:0.5rem}.h-5{height:1.25rem}.h-8{height:2rem}.h-full{height:100%}.w-screen{width:100vw}.w-2{width:0.5rem}.w-8{width:2rem}.w-full{width:100%}.flex-col{flex-direction:column}.items-center{align-items:center}.justify-center{justify-content:center}.gap-2{gap:0.5rem}.space-y-1 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.25rem * var(--tw-space-y-reverse))}.space-y-6 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1.5rem * var(--tw-space-y-reverse))}.break-all{word-break:break-all}.rounded-full{border-radius:9999px}.border{border-width:1px}.border-b{border-bottom-width:1px}.border-l{border-left-width:1px}.border-r{border-right-width:1px}.border-t{border-top-width:1px}.border-gray-600{--tw-border-opacity:1;border-color:rgb(75 85 99 / var(--tw-border-opacity, 1))}.border-white\/30{border-color:rgb(255 255 255 / 0.3)}.bg-gray-900{--tw-bg-opacity:1;background-color:rgb(17 24 39 / var(--tw-bg-opacity, 1))}.bg-gray-800{--tw-bg-opacity:1;background-color:rgb(31 41 55 / var(--tw-bg-opacity, 1))}.bg-yellow-400{--tw-bg-opacity:1;background-color:rgb(250 204 21 / var(--tw-bg-opacity, 1))}.bg-gradient-to-tr{background-image:linear-gradient(to top right, var(--tw-gradient-stops))}.from-indigo-500{--tw-gradient-from:#6366f1 var(--tw-gradient-from-position);--tw-gradient-to:rgb(99 102 241 / 0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from), var(--tw-gradient-to)}.to-purple-500{--tw-gradient-to:#a855f7 var(--tw-gradient-to-position)}.px-3{padding-left:0.75rem;padding-right:0.75rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.px-8{padding-left:2rem;padding-right:2rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.pb-24{padding-bottom:6rem}.pt-16{padding-top:4rem}.text-left{text-align:left}.font-mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-\[10px\]{font-size:10px}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:0.75rem;line-height:1rem}.font-black{font-weight:900}.font-bold{font-weight:700}.leading-relaxed{line-height:1.625}.leading-tight{line-height:1.25}.tracking-tight{letter-spacing:-0.025em}.tracking-wide{letter-spacing:0.025em}.tracking-wider{letter-spacing:0.05em}.text-black{--tw-text-opacity:1;color:rgb(0 0 0 / var(--tw-text-opacity, 1))}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.text-gray-800{--tw-text-opacity:1;color:rgb(31 41 55 / var(--tw-text-opacity, 1))}.text-gray-900{--tw-text-opacity:1;color:rgb(17 24 39 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.hover\:text-gray-600:hover{--tw-text-opacity:1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}</style></head>
<body class="h-screen w-screen flex items-center justify-center bg-gray-900">

    <div class="hint-text">
        <i class="fas fa-arrows-alt-h mr-2"></i>傾けるかタップして裏返す
    </div>

    <button id="sensor-btn" class="fixed top-5 left-5 text-white text-xs bg-gray-800 px-3 py-2 rounded-full hidden z-50 border border-gray-600">
        <i class="fas fa-mobile-alt mr-2"></i>モーション許可
    </button>

    <!-- カード全体 -->
    <div id="card" class="card-container" style="transition: transform 0.1s ease-out; transform: rotateX(-16.2069deg) rotateY(-2.17119deg); --pointer-x: 118.7120361328125px; --pointer-y: 515.4318017959595px; --bg-x: 45.65762004175365%; --bg-y: 17.58620689655173%;">
        <!-- 表面: "relative"クラスを削除し、絶対配置を有効化 -->
        <div class="card-face card-front">
            <div class="hologram"></div>
            <div class="glare"></div>
            
            <div class="lot-logo">
                l<span class="lot-o"></span>t
            </div>
            
            <div class="absolute top-4 left-4 w-2 h-2 border-t border-l border-white/30"></div>
            <div class="absolute top-4 right-4 w-2 h-2 border-t border-r border-white/30"></div>
            <div class="absolute bottom-4 left-4 w-2 h-2 border-b border-l border-white/30"></div>
            <div class="absolute bottom-4 right-4 w-2 h-2 border-b border-r border-white/30"></div>
        </div>

        <!-- 裏面: "relative"クラスを削除し、絶対配置を有効化 -->
        <div class="card-face card-back text-gray-900">
            <div class="hologram"></div>
            <div class="glare"></div>

            <div class="w-full h-full px-8 pt-16 pb-24 flex flex-col justify-center relative text-content space-y-6">
                
                <!-- 名前情報 -->
                <div>
                    <p class="text-xs font-bold text-gray-500 mb-1">代表</p>
                    <h1 class="text-3xl font-black tracking-wide text-black mb-1 leading-tight" style="font-feature-settings: 'palt';">秋山 潤樹</h1>
                    <p class="text-xs font-bold text-gray-400">Junki Akiyama</p>
                </div>

                <!-- 連絡先 -->
                <div class="space-y-1">
                    <p class="text-xl font-bold tracking-wider text-gray-900 font-mono">080-7095-3872</p>
                    <p class="text-xs font-bold tracking-wide text-gray-800 font-mono break-all">lot610.junki@gmail.com</p>
                </div>

                <!-- 肩書き -->
                <div>
                    <p class="text-xs font-bold text-gray-600 tracking-tight leading-relaxed">
                        スマホ講師 / AIプランナー /<br>空間デザイナー
                    </p>
                </div>
            </div>

            <!-- 下部の黄色いライン -->
            <div class="absolute bottom-0 left-0 w-full h-5 bg-yellow-400 z-20"></div>
        </div>
    </div>

    <!-- 操作メニュー -->
    <div class="menu-bar">
        <button onclick="openAIChat()" class="menu-btn ai-btn" title="AIとチャット">
            <i class="fas fa-sparkles"></i>
        </button>
        <button onclick="downloadSelf()" class="menu-btn download-btn" title="HTMLファイルを保存">
            <i class="fas fa-file-download"></i>
        </button>
        <button onclick="toggleFlip()" class="menu-btn" title="裏返す">
            <i class="fas fa-sync-alt"></i>
        </button>
        <button onclick="showQRCode()" class="menu-btn" title="QRコード">
            <i class="fas fa-qrcode"></i>
        </button>
        <button onclick="shareCard()" class="menu-btn" title="共有">
            <i class="fas fa-share-alt"></i>
        </button>
    </div>

    <!-- QRコードモーダル -->
    <div id="qr-modal" class="modal" onclick="closeModal(event, 'qr-modal')">
        <div class="modal-content" onclick="event.stopPropagation()">
            <h3 class="text-lg font-bold mb-4">名刺を読み取る</h3>
            <div id="qrcode" class="flex justify-center mb-4" title="blob:https://32m1qg6bred9dk8hhuj99hq7vdjovswx0fwqjhegxdhbz3b3q3-h836671216.scf.usercontent.goog/b1bac743-255a-48e5-8f54-a2e8803efdb8"><canvas width="180" height="180" style="display: none;"></canvas><img src="data:image/png;base64,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" style="display: block;"></div>
            <p class="text-xs text-gray-500">カメラでスキャンしてください</p>
            <button onclick="document.getElementById('qr-modal').classList.remove('active')" class="mt-4 px-6 py-2 bg-gray-800 text-white rounded-full text-sm">閉じる</button>
        </div>
    </div>

    <!-- AIチャットモーダル -->
    <div id="ai-modal" class="modal" onclick="closeModal(event, 'ai-modal')">
        <div class="modal-content chat-modal-content" onclick="event.stopPropagation()">
            <!-- ヘッダー -->
            <div class="chat-header">
                <div class="flex items-center gap-2">
                    <div class="w-8 h-8 rounded-full bg-gradient-to-tr from-indigo-500 to-purple-500 flex items-center justify-center text-white text-xs">
                        AI
                    </div>
                    <div class="text-left">
                        <div class="text-sm font-bold">Digital Junki</div>
                        <div class="text-[10px] text-gray-500">Powered by Gemini</div>
                    </div>
                </div>
                <button onclick="document.getElementById('ai-modal').classList.remove('active')" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <!-- メッセージエリア -->
            <div id="chat-messages" class="chat-messages">
                <div class="message ai">
                    こんにちは！秋山潤樹のAIアバターです✨<br>
                    私の仕事やスキルについて、何でも聞いてください。<br>
                    例：「どんな仕事をしてるの？」「おすすめのスマホは？」
                </div>
            </div>

            <!-- タイピングインジケーター -->
            <div id="typing-indicator" class="typing-indicator ml-4 mb-2">
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
            </div>

            <!-- 入力エリア -->
            <div class="chat-input-area">
                <input type="text" id="chat-input" class="chat-input" placeholder="メッセージを入力..." onkeypress="handleKeyPress(event)">
                <button onclick="sendMessage()" class="send-btn">
                    <i class="fas fa-paper-plane text-sm"></i>
                </button>
            </div>
        </div>
    </div>

    <script>
        const apiKey = ""; 

        const card = document.getElementById('card');
        const container = document.body;
        const sensorBtn = document.getElementById('sensor-btn');
        let isFlipped = false;
        let bounds;

        // --- AI Chat Logic ---
        function openAIChat() {
            document.getElementById('ai-modal').classList.add('active');
            setTimeout(() => document.getElementById('chat-input').focus(), 100);
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        async function sendMessage() {
            const inputEl = document.getElementById('chat-input');
            const messagesEl = document.getElementById('chat-messages');
            const typingIndicator = document.getElementById('typing-indicator');
            const text = inputEl.value.trim();

            if (!text) return;

            appendMessage(text, 'user');
            inputEl.value = '';

            typingIndicator.style.display = 'flex';
            messagesEl.scrollTop = messagesEl.scrollHeight;

            try {
                const systemPrompt = `
                    あなたは「秋山 潤樹（Junki Akiyama）」のデジタル名刺に搭載されたAIアバターです。
                    以下のペルソナになりきって、ユーザーの質問に日本語で親しみやすく答えてください。
                    
                    【プロフィール】
                    - 名前: 秋山 潤樹
                    - 職業: スマホ講師、AIプランナー、空間デザイナー
                    - 代表: "lot" という屋号またはチームの代表
                    - 性格: テック好き、フレンドリー、教えるのが上手
                    - 連絡先: 080-7095-3872, lot610.junki@gmail.com
                    
                    【詳細情報】
                    - 現在は建設業に従事しながら、将来的にスマホ関連の仕事を副業から始め、最終的にはストック型収入を構築してFIREを目指している。
                    - 活動は土日祝日が中心。少人数制のスクール形式を希望。
                    - 居住地: 神奈川県海老名市。
                    - 資格: 東京都デジタルサービス局 東京スマホサポーター登録済み。
                    - 経験: 茨城県境町でボランティアのスマホ教室を開催。
                    - ガジェット愛: 毎年携帯電話を買い替えるほどスマホが好き。現在はGoogle Pixel（Android）ユーザー。
                    - エピソード: 祖母にスマホの使い方を教えたり、交流会で保育士にAIを使った資料作りを教えて喜ばれた経験あり。
                    - 趣味: 週に3から4回ジムに通っている。

                    【ルール】
                    - 回答は短く簡潔に（200文字以内推奨）。
                    - 絵文字を適度に使って ✨
                    - スマホの使い方やAI活用術について聞かれたら、専門家としてアドバイスする。
                    - 建設業の話は聞かれない限りは自分からはあまりせず、スマホ講師やAIプランナーとしての側面を強調する。
                    - HTMLやMarkdownは使わず、プレーンテキストで答えること（箇条書きはOK）。
                `;

                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{ text: text }]
                        }],
                        systemInstruction: {
                            parts: [{ text: systemPrompt }]
                        }
                    })
                });

                if (!response.ok) throw new Error('API Error');

                const data = await response.json();
                const aiText = data.candidates?.[0]?.content?.parts?.[0]?.text || "すみません、今ちょっと考え事がまとまりません💦 時間を置いてもう一度聞いてみてください。";

                typingIndicator.style.display = 'none';
                appendMessage(aiText, 'ai');

            } catch (error) {
                console.error(error);
                typingIndicator.style.display = 'none';
                appendMessage("エラーが発生しました。通信環境を確認してください🙇‍♂️", 'ai');
            }
        }

        function appendMessage(text, sender) {
            const messagesEl = document.getElementById('chat-messages');
            const msgDiv = document.createElement('div');
            msgDiv.className = `message ${sender}`;
            
            if (sender === 'ai') {
                msgDiv.innerHTML = marked.parse(text);
            } else {
                msgDiv.textContent = text;
            }
            
            messagesEl.appendChild(msgDiv);
            messagesEl.scrollTop = messagesEl.scrollHeight;
        }

        // --- Existing Functions ---
        
        function downloadSelf() {
            // ダウンロード時はファイル名を index.html にするよう誘導
            const htmlContent = document.documentElement.outerHTML;
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'index.html'; // GitHub Pages用にはindex.htmlがベスト
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            alert('名刺ファイル(index.html)を保存しました。\nGitHub Pagesで公開する際は、このファイル名が重要になります。');
        }

        function rotateCard(e) {
            if (document.querySelector('.modal.active')) return;

            if (!bounds) bounds = card.getBoundingClientRect();
            
            let clientX, clientY;
            if (e.type.includes('touch')) {
                clientX = e.touches[0].clientX;
                clientY = e.touches[0].clientY;
            } else {
                clientX = e.clientX;
                clientY = e.clientY;
            }

            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;
            const mouseX = clientX - centerX;
            const mouseY = clientY - centerY;
            
            const rotateX = (mouseY / centerY) * -20; 
            const rotateY = (mouseX / centerX) * 20;

            applyTransform(rotateX, rotateY, clientX, clientY);
        }

        function handleOrientation(event) {
            if (document.querySelector('.modal.active')) return;

            const beta = event.beta;
            const gamma = event.gamma;
            const rotateX = Math.max(-25, Math.min(25, beta - 45)) * -1;
            const rotateY = Math.max(-25, Math.min(25, gamma));
            const clientX = (window.innerWidth / 2) + (gamma * 5);
            const clientY = (window.innerHeight / 2) + ((beta - 45) * 5);
            applyTransform(rotateX, rotateY, clientX, clientY);
        }

        function applyTransform(rotateX, rotateY, lightX, lightY) {
            const currentRotateY = isFlipped ? rotateY + 180 : rotateY;
            card.style.transform = `rotateX(${rotateX}deg) rotateY(${currentRotateY}deg)`;
            const cardRect = card.getBoundingClientRect();
            const x = lightX - cardRect.left;
            const y = lightY - cardRect.top;
            card.style.setProperty('--pointer-x', `${x}px`);
            card.style.setProperty('--pointer-y', `${y}px`);
            const bgX = 50 + (rotateY * 2) + '%';
            const bgY = 50 + (rotateX * 2) + '%';
            card.style.setProperty('--bg-x', bgX);
            card.style.setProperty('--bg-y', bgY);
        }

        document.addEventListener('mousemove', rotateCard);
        document.addEventListener('touchmove', rotateCard);
        
        function toggleFlip() {
            isFlipped = !isFlipped;
            card.style.transition = 'transform 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
            if(isFlipped) {
                card.style.transform = `rotateX(0deg) rotateY(180deg)`;
            } else {
                card.style.transform = `rotateX(0deg) rotateY(0deg)`;
            }
            setTimeout(() => {
                card.style.transition = 'transform 0.1s ease-out';
            }, 600);
        }
        card.addEventListener('click', toggleFlip);

        if (typeof DeviceOrientationEvent !== 'undefined' && typeof DeviceOrientationEvent.requestPermission === 'function') {
            sensorBtn.classList.remove('hidden');
            sensorBtn.addEventListener('click', () => {
                DeviceOrientationEvent.requestPermission()
                    .then(response => {
                        if (response === 'granted') {
                            window.addEventListener('deviceorientation', handleOrientation);
                            sensorBtn.classList.add('hidden');
                        } else {
                            alert('センサーの使用が拒否されました');
                        }
                    })
                    .catch(console.error);
            });
        } else {
            window.addEventListener('deviceorientation', handleOrientation);
        }

        const qrContainer = document.getElementById('qrcode');
        let qrcodeObj = new QRCode(qrContainer, {
            text: window.location.href,
            width: 180,
            height: 180,
            colorDark : "#000000",
            colorLight : "#ffffff",
            correctLevel : QRCode.CorrectLevel.H
        });

        function showQRCode() {
            // QRコードを表示する前に、もしGitHub Pages等のURLになっていたら自動でそれに合わせる
            // (このコードは自動で現在のURLを取得してQRコードにします)
            qrcodeObj.clear();
            qrcodeObj.makeCode(window.location.href);
            document.getElementById('qr-modal').classList.add('active');
        }

        function closeModal(e, modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        async function shareCard() {
            const shareData = {
                title: '秋山 潤樹 - デジタル名刺',
                text: 'スマホ講師・AIプランナー 秋山潤樹の名刺です。',
                url: window.location.href
            };
            if (navigator.share) {
                try {
                    await navigator.share(shareData);
                } catch (err) {
                    console.log('Share canceled');
                }
            } else {
                copyToClipboard();
            }
        }

        function copyToClipboard() {
            const el = document.createElement('textarea');
            el.value = window.location.href;
            document.body.appendChild(el);
            el.select();
            document.execCommand('copy');
            document.body.removeChild(el);
            alert('URLをクリップボードにコピーしました！');
        }

        window.addEventListener('resize', () => {
            bounds = card.getBoundingClientRect();
        });
    </script>

</body></html>